<!--
 * Copyright (C) 2009, 2010 BonitaSoft S.A.
 * BonitaSoft, 31 rue Gustave Eiffel - 38000 Grenoble
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 2.0 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 -->
<project name="getConnectors" basedir="." default="getConnectors" xmlns:tigris="tigris:org.tigris.subversion.svnant">
	
	<typedef resource="org/bonitasoft/studio/antTasks/antlib-standalone.xml"/>
	
	<property name="connectors" value="${basedir}/connectors"/>
	<property name="connectors.group.id" value="org/bonitasoft/connectors"/>
	<property name="connectors.artifact.id" value="bonita-connectors-package"/>
	<property name="connectors.deps.target" value="${basedir}/dependencies"/>
	<property name="connectors.def.target" value="${basedir}/connectors-def"/>
	<property name="connectors.impl.target" value="${basedir}/connectors-impl"/>
	
	<target name="getConnectors" depends="clean,copy">
	</target>
		
	<target name="clean">
		<delete dir="${connectors.impl.target}" failonerror="false"/>
		<mkdir dir="${connectors.impl.target}"/>
		<delete dir="${connectors.deps.target}" failonerror="false"/>
		<mkdir dir="${connectors.deps.target}"/>
		<delete dir="${connectors.def.target}" failonerror="false"/>
		<mkdir dir="${connectors.def.target}"/>
		
		<delete dir="${connectors}" failonerror="false"/>
		<mkdir dir="${connectors}"/>
	</target>
	
	<target name="copy" >
		<unzip dest="${connectors}">
			<fileset dir="${maven.repo}/${connectors.group.id}/${connectors.artifact.id}/${artifactVersion}/" includes="${connectors.artifact.id}-${artifactVersion}-package.zip"/>
		</unzip>
		
		<unzip dest="${connectors}">
			<fileset dir="${connectors}" includes="*.zip"/>
		</unzip>
		<delete failonerror="false">
			<fileset dir="${connectors}" includes="*.zip"/>
		</delete>
		
		<copy todir="${connectors.deps.target}">
			<fileset dir="${connectors}/classpath" includes="*.jar"/>
		</copy>
		<delete dir="${connectors}/classpath" failonerror="false"/>
		
		<copy todir="${connectors.def.target}">
			<fileset dir="${connectors}" excludes="*.impl"/>
		</copy>
		<copy todir="${connectors.impl.target}">
			<fileset dir="${connectors}" includes="*.impl"/>
		</copy>
		
		<delete dir="${connectors}" failonerror="false"/>
	</target>
	
</project>
