<!--
 * Copyright (C) 2009, 2010 BonitaSoft S.A.
 * BonitaSoft, 31 rue Gustave Eiffel - 38000 Grenoble
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 2.0 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 -->
<project name="getuserfilter" basedir="." default="getuserfilter" xmlns:tigris="tigris:org.tigris.subversion.svnant">
	
	<typedef resource="org/bonitasoft/studio/antTasks/antlib-standalone.xml"/>
	
	<property name="userfilter" value="${basedir}/userfilter"/>
	<property name="userfilter.group.id" value="org/bonitasoft/userfilter"/>
	<property name="userfilter.artifact.id" value="bonita-userfilter-package"/>
	<property name="userfilter.deps.target" value="${basedir}/dependencies"/>
	<property name="userfilter.def.target" value="${basedir}/filters-def"/>
	<property name="userfilter.impl.target" value="${basedir}/filters-impl"/>
	
	<target name="getuserfilter" depends="clean,copy">
	</target>
		
	<target name="clean">
		<delete dir="${userfilter.impl.target}" failonerror="false"/>
		<mkdir dir="${userfilter.impl.target}"/>
		<delete dir="${userfilter.deps.target}" failonerror="false"/>
		<mkdir dir="${userfilter.deps.target}"/>
		<delete dir="${userfilter.def.target}" failonerror="false"/>
		<mkdir dir="${userfilter.def.target}"/>
		
		<delete dir="${userfilter}" failonerror="false"/>
		<mkdir dir="${userfilter}"/>
	</target>
	
	<target name="copy" >
		<unzip dest="${userfilter}">
			<fileset dir="${maven.repo}/${userfilter.group.id}/${userfilter.artifact.id}/${artifactVersion}/" includes="${userfilter.artifact.id}-${artifactVersion}-package.zip"/>
		</unzip>
		
		<unzip dest="${userfilter}">
			<fileset dir="${userfilter}" includes="*.zip"/>
		</unzip>
		<delete failonerror="false">
			<fileset dir="${userfilter}" includes="*.zip"/>
		</delete>
		
		<copy todir="${userfilter.deps.target}">
			<fileset dir="${userfilter}/classpath" includes="*.jar"/>
		</copy>
		<delete dir="${userfilter}/classpath" failonerror="false"/>
		
		<copy todir="${userfilter.def.target}">
			<fileset dir="${userfilter}" excludes="*.impl"/>
		</copy>
		<copy todir="${userfilter.impl.target}">
			<fileset dir="${userfilter}" includes="*.impl"/>
		</copy>
		
		<delete dir="${userfilter}" failonerror="false"/>
	</target>
	
</project>
